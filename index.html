<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoTag Pro Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#0d6efd"> 

    <style>
        :root {
            --bs-primary: #0d6efd;
            --bs-primary-rgb: 13, 110, 253;
            --bs-dashboard-bg: #f8f9fa; /* Light Gray */
        }
        body {
            background-color: var(--bs-dashboard-bg);
        }
        .modal.fullscreen .modal-dialog {
            width: 100vw;
            height: 100vh;
            margin: 0;
            max-width: none;
        }
        .modal.fullscreen .modal-content {
            height: 100%;
            border: 0;
        }
        /* Premium Card Look */
        .tool-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            border-radius: 12px; /* Smoother corners */
            border: none;
            overflow: hidden;
            background: white;
        }
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,.08) !important;
        }
        .tool-card.disabled-for-auth {
            cursor: not-allowed;
            opacity: 0.6;
            background-color: #f1f1f1;
        }
        .tool-card-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        /* Responsive Table */
        .table-responsive-lg {
            max-height: calc(100vh - 180px); /* Adjust height for full-screen modal */
            overflow: auto;
        }
        /* Inline Edit Styling */
        .lead-inline-edit {
            padding: 0.25rem 0.4rem;
            font-size: 0.8rem;
            height: auto;
            border: 1px solid #dee2e6;
            border-radius: 6px;
        }
        .lead-inline-edit:focus {
            border-color: var(--bs-primary);
            box-shadow: 0 0 0 0.15rem rgba(13, 110, 253, .15);
        }
        .lead-inline-edit.is-valid {
            border-color: #198754;
            background-color: #d1e7dd; /* Light green background */
        }
        .lead-inline-edit.is-invalid {
            border-color: #dc3545;
            background-color: #f8d7da; /* Light red background */
        }
    </style>
</head>
<body>

    <div id="notificationContainer" class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1050;"></div>
    
    <div id="installBanner" class="alert alert-dark mb-0 p-2 d-none shadow-lg" role="alert" style="z-index: 1040;">
        <span class="material-symbols-outlined me-2">download</span>
        Install app for a full-screen, faster experience.
        <button id="installButton" class="btn btn-sm btn-outline-dark ms-3">Install</button>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top shadow-lg">
  <div class="container-fluid">
    <button class="navbar-toggler me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNav" aria-controls="offcanvasNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <a class="navbar-brand fw-bold" href="#">GeoTag Pro</a>

    <div class="d-flex align-items-center ms-auto">

      <!-- Google Sign-In/Out Buttons -->
      <div id="googleSignInButtonContainer" class="me-3">
        <button id="googleSignInBtn" class="btn btn-outline-light btn-sm">Sign in with Google</button>
        <button id="googleSignOutBtn" class="btn btn-danger btn-sm d-none">Sign out</button>
      </div>

      <!-- User Profile Dropdown -->
      <div class="dropdown d-none" id="userProfileDisplay">
        <a class="nav-link dropdown-toggle d-flex align-items-center p-0" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          <img id="userPhoto" src="./Assets/icons/icon-256x256.png" class="rounded-circle me-2 border border-3 border-light" alt="User" style="width: 38px; height: 38px; object-fit: cover;">
        </a>
        <ul class="dropdown-menu dropdown-menu-end shadow-lg" aria-labelledby="navbarDropdown">
          <li><h6 class="dropdown-header fw-bold" id="userName">User</h6></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item text-danger fw-semibold" href="#" id="navbarSignOut">Sign Out</a></li>
        </ul>
      </div>

    </div>
  </div>
</nav>
    
    <div class="offcanvas offcanvas-start bg-dark text-white" tabindex="-1" id="offcanvasNav" aria-labelledby="offcanvasNavLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title fw-bold text-primary" id="offcanvasNavLabel">GeoTag Pro Tools</h5>
            <button type="button" class="btn-close text-reset btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body d-flex flex-column">
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                <li class="nav-item mb-2">
                    <a class="btn btn-outline-light d-flex align-items-center w-100" data-bs-toggle="modal" data-bs-target="#digitSpellerModal" href="#">
                        <span class="material-symbols-outlined me-2">calculate</span> Digit Speller
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a class="btn btn-outline-light d-flex align-items-center w-100" data-bs-toggle="modal" data-bs-target="#denominationModal" href="#">
                        <span class="material-symbols-outlined me-2">currency_rupee</span> Cash Tally
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a class="btn btn-outline-light d-flex align-items-center w-100" data-bs-toggle="modal" data-bs-target="#emiCalculatorModal" href="#">
                        <span class="material-symbols-outlined me-2">percent</span> EMI Calculator
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="container-fluid py-4">
  <h1 class="h3 fw-bold mb-4 text-dark">Dashboard Overview</h1>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">

    <!-- Geo Camera -->
    <div class="col">
      <div class="card shadow-sm tool-card clickable-card" onclick="window.location.href='geo.html'">
        <div class="card-body d-flex flex-column align-items-start">
          <span class="material-symbols-outlined text-primary tool-card-icon">photo_camera_front</span>
          <h3 class="card-title h5 text-dark fw-bold mb-1">Geo Camera</h3>
          <p class="card-text small text-muted">Capture photos with GPS location and timestamp details.</p>
        </div>
      </div>
    </div>

    <!-- Digital Diary -->
    <div class="col">
      <div class="card shadow-sm tool-card clickable-card" onclick="window.location.href='dairy.html'">
        <div class="card-body d-flex flex-column align-items-start">
          <span class="material-symbols-outlined text-info tool-card-icon">menu_book</span>
          <h3 class="card-title h5 text-dark fw-bold mb-1">Digital Diary</h3>
          <p class="card-text small text-muted">Write, store, and manage daily notes digitally.</p>
        </div>
      </div>
    </div>


    <!-- Digit Speller -->
    <div class="col">
      <div class="card shadow-sm tool-card clickable-card" data-bs-toggle="modal" data-bs-target="#digitSpellerModal">
        <div class="card-body d-flex flex-column align-items-start">
          <span class="material-symbols-outlined text-warning tool-card-icon">spellcheck</span>
          <h3 class="card-title h5 text-dark fw-bold mb-1">Digit Speller (Indian)</h3>
          <p class="card-text small text-muted">Convert numerical digits into words using the Indian numbering system.</p>
        </div>
      </div>
    </div>

    <!-- Cash Denomination -->
    <div class="col">
      <div class="card shadow-sm tool-card clickable-card" data-bs-toggle="modal" data-bs-target="#denominationModal">
        <div class="card-body d-flex flex-column align-items-start">
          <span class="material-symbols-outlined text-danger tool-card-icon">currency_rupee</span>
          <h3 class="card-title h5 text-dark fw-bold mb-1">Cash Denomination Tally</h3>
          <p class="card-text small text-muted">Quickly calculate total cash amount based on note and coin counts.</p>
        </div>
      </div>
    </div>

    <!-- EMI Calculator -->
    <div class="col">
      <div class="card shadow-sm tool-card clickable-card" data-bs-toggle="modal" data-bs-target="#emiCalculatorModal">
        <div class="card-body d-flex flex-column align-items-start">
          <span class="material-symbols-outlined text-danger tool-card-icon">percent</span>
          <h3 class="card-title h5 text-dark fw-bold mb-1">EMI Calculator</h3>
          <p class="card-text small text-muted">Calculate loan EMIs easily with accurate breakdowns.</p>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Optional Card Hover/Clickable Style -->
<style>
  .tool-card {
    border-radius: 1rem;
    transition: all 0.25s ease-in-out;
    cursor: pointer;
  }

  .tool-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  }

  .tool-card-icon {
    font-size: 40px;
    margin-bottom: 10px;
  }

  .clickable-card {
    cursor: pointer;
  }
</style>

    <div class="modal fade" id="digitSpellerModal" tabindex="-1" aria-labelledby="digitSpellerModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="digitSpellerModalLabel">Digit to Word Speller (Indian)</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="digitInput" class="form-label small fw-semibold">Enter Number (Max 9 Digits)</label>
                        <input type="number" class="form-control form-control-lg shadow-sm" id="digitInput" max="999999999" placeholder="e.g., 10000000">
                    </div>
                    <h6 class="mt-4">Spelling:</h6>
                    <p class="alert alert-light border border-success fw-bold p-3" id="spellingOutput">Enter a number to see the spelling.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="denominationModal" tabindex="-1" aria-labelledby="denominationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title" id="denominationModalLabel">Cash Denomination Tally</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table-sm">
                            <thead class="bg-light">
                                <tr>
                                    <th class="small">Denomination</th>
                                    <th class="text-center small">Count</th>
                                    <th class="text-end small">Amount (â‚¹)</th>
                                </tr>
                            </thead>
                            <tbody id="denominationTallyBody">
                                </tbody>
                            <tfoot>
                                <tr class="table-primary fw-bold">
                                    <th colspan="2" class="text-end">GRAND TOTAL</th>
                                    <th class="text-end" id="grandTotalDisplay">â‚¹0</th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="emiCalculatorModal" tabindex="-1" aria-labelledby="emiCalculatorModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="emiCalculatorModalLabel">EMI Calculator</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 border-end">
                            <h6 class="fw-bold text-danger mb-3">Input Parameters</h6>
                            <div class="mb-3">
                                <label for="principalInput" class="form-label small fw-semibold">Loan Amount (â‚¹)</label>
                                <input type="number" class="form-control emi-calc-input shadow-sm" id="principalInput" value="500000" min="0">
                            </div>
                            <div class="mb-3">
                                <label for="timeInput" class="form-label small fw-semibold">Loan Term (Years)</label>
                                <input type="number" class="form-control emi-calc-input shadow-sm" id="timeInput" value="5" min="0.5" step="0.5">
                            </div>
                            <div class="mb-4">
                                <label for="rateSlider" class="form-label small fw-semibold">Interest Rate: <span id="rateDisplay" class="fw-bold text-danger">10.00%</span></label>
                                <input type="range" class="form-range emi-calc-input" id="rateSlider" min="1" max="25" step="0.01" value="10">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6 class="fw-bold text-dark mb-3">Calculation Results</h6>
                            <ul class="list-group list-group-flush mb-4">
                                <li class="list-group-item d-flex justify-content-between align-items-center fw-semibold">
                                    Monthly EMI:
                                    <span class="badge bg-primary fs-6 rounded-pill p-2" id="outputEMI">â‚¹0</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center small">
                                    Total Principal:
                                    <span class="text-success" id="outputPrincipal">â‚¹5,00,000</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center small">
                                    Total Interest Payable:
                                    <span class="text-danger" id="outputTotalInterest">â‚¹0</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center fw-semibold">
                                    Total Payment:
                                    <span class="text-dark" id="outputTotalPayment">â‚¹0</span>
                                </li>
                            </ul>
                            <div style="height: 250px;">
                                <canvas id="emiPieChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="profileModalLabel">User Profile</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="modalUserPhoto" src="./Assets/icons/icon-256x256.png" class="rounded-circle mb-3 border border-3 border-primary" alt="User" style="width: 100px; height: 100px; object-fit: cover;">
                    <h5 id="modalUserName" class="fw-bold">User</h5>
                    <p class="text-muted small" id="modalUserEmail">N/A</p>
                    <hr>
                    <button class="btn btn-danger fw-semibold" onclick="window.signOutUser()" data-bs-dismiss="modal">Sign Out</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    
    <script type="module">
  import { 
    initializeApp 
  } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
  import { 
    getAnalytics 
  } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-analytics.js";
  import { 
    getAuth, 
    GoogleAuthProvider, 
    signInWithPopup, 
    onAuthStateChanged, 
    signOut 
  } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";
  import * as database 
    from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

  // ------------------ Firebase Config ------------------
  const firebaseConfig = {
    apiKey: "AIzaSyCLb8Fcl_Yqqd0EYXciu5wbrAj7-mz1o9M",
    authDomain: "officetools-629fc.firebaseapp.com",
    databaseURL: "https://officetools-629fc-default-rtdb.firebaseio.com",
    projectId: "officetools-629fc",
    storageBucket: "officetools-629fc.firebasestorage.app",
    messagingSenderId: "888485297465",
    appId: "1:888485297465:web:f832733b7b78d361067ce8",
    measurementId: "G-8QE15667LC"
  };

  // ------------------ Initialize Firebase ------------------
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);
  const db = database.getDatabase(app);
  const googleProvider = new GoogleAuthProvider();

  window.FIREBASE_USER_UID = null;
  window.RTDB = db;

  // ------------------ Helper: Update UI ------------------
  function updateUI(user) {
    if (user) {
      // Show user info
      $("#googleSignInBtn").hide();
      $("#googleSignOutBtn").show();
      $("#userProfileDisplay").removeClass("d-none");
      $("#userName").text(user.displayName);
      $("#userPhoto").attr("src", user.photoURL || "./Assets/icons/icon-256x256.png");
    } else {
      // Hide user info
      $("#googleSignInBtn").show();
      $("#googleSignOutBtn").hide();
      $("#userProfileDisplay").addClass("d-none");
      $("#userName").text("User");
      $("#userPhoto").attr("src", "./Assets/icons/icon-256x256.png");
    }
  }

  // ------------------ Sign-In Function ------------------
  async function handleGoogleSignIn() {
    try {
      const result = await signInWithPopup(auth, googleProvider);
      const user = result.user;
      console.log("âœ… User signed in:", user.displayName);

      window.FIREBASE_USER_UID = user.uid;

      // Save user info in Firebase
      const userRef = database.ref(db, `users/${user.uid}`);
      await database.set(userRef, {
        name: user.displayName,
        email: user.email,
        photoURL: user.photoURL,
        lastLogin: new Date().toISOString()
      });

      // Save to Local Storage
      localStorage.setItem("userUID", user.uid);
      localStorage.setItem("userName", user.displayName);
      localStorage.setItem("userEmail", user.email);
      localStorage.setItem("userPhoto", user.photoURL);

      updateUI(user);
      alert(`Welcome ${user.displayName}`);
    } catch (error) {
      console.error("âŒ Sign-in failed:", error.message);
      alert("Sign-in failed. Please try again.");
    }
  }

  // ------------------ Sign-Out Function ------------------
  async function handleSignOut() {
    try {
      await signOut(auth);
      console.log("ðŸšª User signed out");

      // Clear Local Storage
      localStorage.removeItem("userUID");
      localStorage.removeItem("userName");
      localStorage.removeItem("userEmail");
      localStorage.removeItem("userPhoto");

      updateUI(null);
      alert("You have been signed out.");
    } catch (error) {
      console.error("âŒ Sign-out failed:", error.message);
    }
  }

  // ------------------ Auth State Listener ------------------
  onAuthStateChanged(auth, (user) => {
    if (user) {
      window.FIREBASE_USER_UID = user.uid;
      console.log("ðŸ”“ Authenticated as:", user.displayName);
      updateUI(user);
    } else {
      console.log("ðŸ”’ No user signed in.");
      updateUI(null);
    }
  });

  // ------------------ Restore from Local Storage ------------------
  $(document).ready(function() {
    const storedUID = localStorage.getItem("userUID");
    const storedName = localStorage.getItem("userName");
    const storedPhoto = localStorage.getItem("userPhoto");

    if (storedUID && storedName) {
      updateUI({
        displayName: storedName,
        photoURL: storedPhoto
      });
    } else {
      updateUI(null);
    }

    // Button Events
    $("#googleSignInBtn").on("click", handleGoogleSignIn);
    $("#googleSignOutBtn").on("click", handleSignOut);
    $("#navbarSignOut").on("click", handleSignOut);
  });
</script>

    <script src="./Assets/tool.js"></script>
    <script src="./Assets/tool1.js"></script>
    
</body>
</html>