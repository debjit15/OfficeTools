<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoTag Pro: Office Tools Dashboard (Lead Management)</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="./Assets/index.css">
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#0d6efd"> 
  

    <style>
        /* Styles to ensure components are visually clear */
        #googleSignInButtonContainer {
            /* Now an explicit container for the simple button */
            display: flex; 
            align-items: center;
        }

        /* Existing Styles */
        #userPhoto {
            cursor: pointer;
        }
        .modal.fullscreen .modal-dialog {
            width: 100vw;
            height: 100vh;
            margin: 0;
            padding: 0;
            max-width: none;
        }
        .modal.fullscreen .modal-content {
            height: 100%;
            border: 0;
            border-radius: 0;
        }
        .fab-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1040;
        }
        .fab-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }
        .fab-button:hover {
            transform: scale(1.05);
        }
        #quickNoteForm .modal-body {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        #noteTextarea {
            flex-grow: 1;
            resize: none;
        }

        /* New styles for Lead Management Table */
        .lead-table-header th {
            font-weight: 600 !important;
            letter-spacing: 0.5px;
        }

    </style>

</head>

<body class="bg-body-bg">
    
    <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom shadow-sm" role="navigation" aria-label="Main Navigation">
        <div class="container-fluid container-xl">
            <a class="navbar-brand text-primary fw-bold d-flex align-items-center" href="#" aria-label="GeoTag Pro Office Tools Dashboard Home">
                <span class="material-symbols-outlined me-2">workspaces</span>
                Office Tools
            </a>
            
            <div class="actions ms-auto d-flex align-items-center" role="group" aria-label="User Actions">
                
                <div id="userProfileDisplay" class="d-flex align-items-center me-3 d-none" role="status" aria-label="User Profile">
                    <img id="userPhoto" src="" alt="User Profile Photo" class="rounded-circle me-2" style="width: 35px; height: 35px;" 
                         data-bs-toggle="modal" data-bs-target="#userAccountModal" title="View Profile">
                    <span id="userName" class="me-3 fw-medium d-none d-sm-block"></span>
                    <button class="btn btn-outline-danger btn-sm" onclick="signOutUser()" aria-label="Sign Out">
                        <span class="material-symbols-outlined fs-6" style="vertical-align: middle;">logout</span>
                    </button>
                </div>

                <div id="googleSignInButtonContainer">
                    <button class="btn btn-primary btn-sm" onclick="googleLogin()" aria-label="Sign in with Google">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="18px" height="18px" style="vertical-align: middle; margin-right: 5px;">
                            <path fill="#FFC107" d="M43.61 20.08v3.46h-11.72l-.02-.02c-2.45-3.52-6.52-5.9-11.19-5.9-8.58 0-15.54 6.96-15.54 15.54s6.96 15.54 15.54 15.54c5.96 0 10.9-3.32 13.56-8.24l.01-.01-5.18-4.01c-1.85 2.87-5.06 4.88-8.39 4.88-4.66 0-8.46-3.8-8.46-8.46s3.8-8.46 8.46-8.46c2.4 0 4.67 1.02 6.27 2.76l.01-.01L43.61 20.08z"/>
                            <path fill="#4CAF50" d="M11.66 11.66h24.68v24.68H11.66z" transform="rotate(45 24 24)" opacity="0"/>
                            <path fill="#4285F4" d="M43.61 20.08h-11.72l-.02-.02c-2.45-3.52-6.52-5.9-11.19-5.9-8.58 0-15.54 6.96-15.54 15.54s6.96 15.54 15.54 15.54c5.96 0 10.9-3.32 13.56-8.24l.01-.01 5.18 4.01c-3.13 4.79-8.48 7.82-14.9 7.82C10.8 44 2.88 36.08 2.88 26.54S10.8 9.08 20.88 9.08c6.91 0 12.83 4.13 15.54 10.02l.01.01h7.18z"/>
                        </svg>
                        Sign in with Google
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main role="main" aria-label="Application Tools Dashboard">
        
        <div class="dashboard-container row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
         
           <div class="col">
  <div id="installBanner" 
       class="alert alert-info shadow-sm border-0 d-flex align-items-center justify-content-between px-3 py-2 rounded-4 d-none"
       role="alert" 
       style="background: linear-gradient(90deg, #e3f2fd, #bbdefb); color:#0d47a1;">

    <div class="d-flex align-items-center gap-2">
      <img src="./Assets/icons/icon-72x72.png" alt="App Icon" class="rounded-3" 
           style="width:36px; height:36px; object-fit:cover;">
      <div>
        <div class="fw-semibold" style="font-size: 0.95rem;">Install GeoTag Tools</div>
        <small style="font-size: 0.8rem; color:#1565c0;">Get offline access and faster load times!</small>
      </div>
    </div>

    <button id="installButton" class="btn btn-primary p-0 shadow-sm"
            style="width:38px; height:38px; border-radius:50%; display:flex; align-items:center; justify-content:center;">
      <span class="material-symbols-outlined" style="font-size:22px;">download</span>
    </button>
  </div>
</div>

            <div class="col">
                <a href="geo.html" class="tool-card" aria-label="Launch GeoTagging Image tool">
                    <span class="material-symbols-outlined">add_location_alt</span>
                    <h3>GeoTagging Image</h3>
                    <p>Launch the camera interface to capture geotagged photos.</p>
                </a>
            </div>
            
            <div class="col">
                <div class="tool-card disabled-for-auth opacity-50" title="Login required to use this tool." role="button" data-bs-toggle="modal" data-bs-target="#leadManageModal">
                    <span class="material-symbols-outlined">storage</span>
                    <h3>Lead Data Management</h3>
                    <p>View the table, delete entries, and export/import data.</p>
                </div>
            </div>

            <div class="col">
                <div class="tool-card" data-bs-toggle="modal" data-bs-target="#spellingModal" role="button" aria-controls="spellingModal" aria-label="Open Digit to Spelling Converter">
                    <span class="material-symbols-outlined">spellcheck</span>
                    <h3>Digit to Spelling</h3>
                    <p>Convert large numeric values into written words.</p>
                </div>
            </div>
           
            <div class="col">
    <div class="tool-card" data-bs-toggle="modal" data-bs-target="#denominationModal" role="button" aria-label="Open Currency Denomination Calculator">
        <span class="material-symbols-outlined">payments</span>
        <h3>Note Denomination</h3>
        <p>Break down a total amount into specified notes and coins.</p>
    </div>
</div>

           <div class="col">
    <div class="tool-card" data-bs-toggle="modal" data-bs-target="#emiCalculatorModal" role="button" aria-controls="emiCalculatorModal" aria-label="Open Simple Interest Calculator">
        <span class="material-symbols-outlined">payments</span>
        <h3>Interest Calculator</h3>
        <p>Calculate simple interest on a principal amount.</p>
    </div>
</div>

        </div>
    </main>
    
    <div id="notificationContainer" style="position: fixed; top: 15px; right: 15px; z-index: 1050;"></div>

    <div class="fab-container d-none" id="quickNoteFab">
        <button type="button" class="fab-button btn btn-primary btn-lg" 
            data-bs-toggle="modal" data-bs-target="#quickNoteModal" title="Quick Note"
            aria-label="Open Quick Note module">
            <span class="material-symbols-outlined fs-3">bookmark_add</span>
        </button>
    </div>

    <div class="modal fade" id="userAccountModal" tabindex="-1" aria-labelledby="userAccountModalLabel" aria-hidden="true" role="dialog">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content text-center">
                <div class="modal-header d-block border-0 pb-0">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close profile"></button>
                </div>
                <div class="modal-body pt-0">
                    <img id="modalUserPhoto" src="" alt="User Profile Photo" class="rounded-circle mb-3" style="width: 80px; height: 80px;">
                    <h5 id="modalUserName" class="text-primary fw-bold mb-1">User Name</h5>
                    <p id="modalUserEmail" class="text-muted small">user.email@example.com</p>
                    <hr>
                    <button type="button" class="btn btn-danger w-100 mt-2" onclick="signOutUser(); bootstrap.Modal.getInstance(document.getElementById('userAccountModal')).hide();" aria-label="Sign Out of Application">
                        <span class="material-symbols-outlined me-1 fs-6">logout</span> Sign Out
                    </button>
                </div>
            </div>
        </div>
    </div>

    
    <div class="modal fade fullscreen" id="denominationModal" tabindex="-1" aria-labelledby="denominationModalLabel" aria-hidden="true" role="dialog">
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-primary" id="denominationModalLabel">Calculate Total from Note Counts</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close calculator"></button>
            </div>
            <div class="modal-body">
                <p class="text-muted small">Enter the count for each note/coin denomination below to calculate the total cash amount.</p>
                
                <form id="noteCountForm">
                    <div id="denominationInputTable" class="table-responsive">
                        <table class="table table-sm table-striped align-middle mb-0">
                            <thead>
                                <tr class="table-primary">
                                    <th scope="col">Note / Coin</th>
                                    <th scope="col" class="text-center">Count</th>
                                    <th scope="col" class="text-end">Amount (竄ｹ)</th>
                                </tr>
                            </thead>
                            <tbody id="denominationTallyBody">
                                </tbody>
                        </table>
                    </div>
                </form>

                <h6 class="mt-4 text-primary">Total Cash Amount:</h6>
                <div id="grandTotalDisplay" class="alert alert-success fw-bold fs-4 text-end" aria-atomic="true">
                    竄ｹ0
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade fullscreen" id="leadEntryModal" tabindex="-1" aria-labelledby="leadEntryModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow-lg border-0 rounded-3 overflow-hidden">
      
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="leadEntryModalLabel">
          <span class="material-symbols-outlined me-2">person_add</span> New Lead Entry
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <form id="noteEntryForm" class="needs-validation" novalidate>
        <div class="modal-body">
          <p class="text-muted small mb-3">
            Fill in the details below to add a new lead. Data is automatically synced with Firebase.
          </p>

          <div class="row g-3">
            <div class="col-md-6">
              <label for="customerName" class="form-label">Customer Name <span class="text-danger">*</span></label>
              <input type="text" class="form-control" id="customerName" placeholder="Enter customer name" required>
            </div>

            <div class="col-md-6">
              <label for="mobileNumber" class="form-label">Mobile Number</label>
              <input type="tel" class="form-control" id="mobileNumber" placeholder="Enter mobile number">
            </div>

            <div class="col-md-6">
              <label for="leadFor" class="form-label">Lead For <span class="text-danger">*</span></label>
              <select class="form-select" id="leadFor" required>
                <option selected disabled value="">Select Lead Type...</option>

                <optgroup label="Banking Products">
                  <option value="Savings Account">Savings Account</option>
                  <option value="Current Account">Current Account</option>
                  <option value="Fixed Deposit (FD)">Fixed Deposit (FD)</option>
                  <option value="Recurring Deposit (RD)">Recurring Deposit (RD)</option>
                </optgroup>

                <optgroup label="Investment & Insurance">
                  <option value="Life Insurance (LI)">Life Insurance (LI)</option>
                  <option value="Mutual Fund / SIP">Mutual Fund / SIP</option>
                </optgroup>

                <optgroup label="Loan Services">
                  <option value="Personal Loan">Personal Loan</option>
                  <option value="Home Loan">Home Loan</option>
                  <option value="Vehicle Loan">Vehicle Loan</option>
                  <option value="Business Loan">Business Loan</option>
                </optgroup>

                <optgroup label="Other">
                  <option value="New Project">New Project</option>
                  <option value="Maintenance">Maintenance</option>
                  <option value="Survey">Survey</option>
                  <option value="Other">Other</option>
                </optgroup>
              </select>
            </div>

            <div class="col-md-6">
              <label for="leadBy" class="form-label">Lead By (Agent Name)</label>
              <input type="text" class="form-control" id="leadBy" placeholder="Enter your name">
            </div>

            <div class="col-md-6">
              <label for="lastContact" class="form-label">Next Contact Date <span class="text-danger">*</span></label>
              <input type="date" class="form-control" id="lastContact" required>
            </div>

            <div class="col-md-6">
              <label for="createdOnDisplay" class="form-label">Created On</label>
              <input type="text" class="form-control" id="createdOnDisplay" placeholder="Auto-set by system" disabled>
            </div>
            
            <div class="col-12">
              <label for="remark" class="form-label">Remark / Action</label>
              <input type="text" class="form-control" id="remark" placeholder="Enter any remarks or action plan">
            </div>
          </div>
        </div>

        <div class="modal-footer bg-light">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <span class="material-symbols-outlined me-1">close</span> Cancel
          </button>
          <button type="submit" class="btn btn-primary">
            <span class="material-symbols-outlined me-1">save</span> Save Lead
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="modal fade fullscreen" id="leadManageModal" tabindex="-1" aria-labelledby="leadManageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content shadow-lg border-0">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="leadManageModalLabel">
          <span class="material-symbols-outlined me-2">table_chart</span> Lead Management
        </h5>
        <div class="ms-auto d-flex align-items-center gap-2">
          <button type="button" class="btn btn-light btn-sm" id="exportPDFBtn" title="Download as PDF">
            <span class="material-symbols-outlined">picture_as_pdf</span>
          </button>
          <button type="button" class="btn btn-success btn-sm" id="addLeadFromManageBtn">
            <span class="material-symbols-outlined me-1">add</span> Add Lead
          </button>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
      </div>

      <div class="modal-body">
        <div class="row mb-3">
    <div class="col-12">
        <input type="text" id="leadSearchInput" class="form-control" placeholder="Search by Name, Mobile, Lead For, or Remark...">
    </div>
</div>


        <div id="noteTableContainer" class="table-responsive">
          <table class="table table-hover align-middle" id="notesTable">
            <thead class="table-primary lead-table-header">
            <tr>
        <th>#</th>
        <th>Customer Name</th>
        <th>Mobile Number</th>
        <th>Lead For</th>
        <th>Lead By</th>
        <th>Last Contact</th>
        <th>Remark</th>
        <th>Date Added</th>
        <th>Last Edited</th>  <th>Call</th>
        <th>Actions</th>
    </tr>
            </thead>
            <tbody>
              </tbody>
          </table>
        </div>
      </div>

      <div class="modal-footer bg-light">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade fullscreen" id="quickNoteModal" tabindex="-1" aria-labelledby="quickNoteModalLabel" aria-hidden="true" role="dialog">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-primary" id="quickNoteModalLabel">Quick Note</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close note entry"></button>
                </div>
                <form id="quickNoteForm">
                    <div class="modal-body">
                        <p class="text-muted small">Saved Notes:</p>
                        <div id="savedNotesContainer" class="mb-3 p-2 border rounded overflow-auto" style="max-height: 20vh;">
                            <p class="text-center text-muted small mb-0">No saved notes.</p>
                        </div>
                        <p class="text-muted small mt-2">New Note:</p>
                        <textarea class="form-control" id="noteTextarea" rows="4" placeholder="Type your new note here..." required></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" aria-label="Save quick note">
                            <span class="material-symbols-outlined me-1 fs-6">save</span> Save Note
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade fullscreen" id="spellingModal" tabindex="-1" aria-labelledby="spellingModalLabel" aria-hidden="true" role="dialog">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-primary" id="spellingModalLabel">Digit to Spelling Converter</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close converter"></button>
                </div>
                <div class="modal-body">
                    <label for="digitInput" class="form-label">Enter Numeric Value:</label>
                    <input type="number" class="form-control" id="digitInput" placeholder="e.g., 1234567" max="999999999999" aria-describedby="spellingOutput">
                    
                    <h6 class="mt-3 text-muted">Result in Words:</h6>
                    <div id="spellingOutput" aria-atomic="true">Enter a digit above.</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Done</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade fullscreen" id="emiCalculatorModal" tabindex="-1" aria-labelledby="emiCalculatorModalLabel" aria-hidden="true" role="dialog">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-primary" id="emiCalculatorModalLabel">Professional Loan/EMI Calculator</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close calculator"></button>
            </div>
            <div class="modal-body">
                <div class="row g-4">
                    <div class="col-lg-6">
                        <h6 class="text-secondary mb-3">Loan Details</h6>
                        
                        <div class="mb-4">
                            <label for="principalInput" class="form-label">Principal Loan Amount (P)</label>
                            <input type="number" class="form-control emi-calc-input" id="principalInput" placeholder="e.g., 500000" value="500000" min="1000">
                        </div>

                        <div class="mb-4">
                            <label for="timeInput" class="form-label">Loan Term (T in Years)</label>
                            <input type="number" class="form-control emi-calc-input" id="timeInput" placeholder="e.g., 5" value="5" min="1">
                        </div>

                        <div class="mb-4">
                            <label for="rateSlider" class="form-label d-flex justify-content-between">
                                Annual Interest Rate (R): <span class="fw-bold text-primary" id="rateDisplay">7.00%</span>
                            </label>
                            <input type="range" class="form-range emi-calc-input" id="rateSlider" min="1" max="25" step="0.01" value="7">
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <h6 class="text-secondary mb-3">Calculation Summary</h6>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <div class="card text-center h-100 shadow-sm">
                                    <div class="card-body">
                                        <p class="card-title text-muted mb-1 small">Monthly EMI</p>
                                        <h4 class="text-primary" id="outputEMI">--</h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card text-center h-100 shadow-sm">
                                    <div class="card-body">
                                        <p class="card-title text-muted mb-1 small">Total Interest</p>
                                        <h4 class="text-danger" id="outputTotalInterest">--</h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card text-center h-100 shadow-sm">
                                    <div class="card-body">
                                        <p class="card-title text-muted mb-1 small">Total Payment</p>
                                        <h4 class="text-success" id="outputTotalPayment">--</h4>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card p-3 shadow-sm">
                             <p class="text-center text-muted small mb-2">Principal vs. Interest Breakdown</p>
                            <div class="chart-container" style="height: 250px;">
                                <canvas id="emiPieChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Done</button>
            </div>
        </div>
    </div>
</div>
    
    <div class="modal fade" id="leadEditModal" tabindex="-1" aria-labelledby="leadEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            
            <div class="modal-header">
                <h5 class="modal-title" id="leadEditModalLabel">Edit Lead Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <div class="modal-body">
                <form id="editLeadForm">
                    
                    <input type="hidden" id="editLeadRtdbKey" name="rtdbKey">

                    <div class="mb-3">
                        <label for="editCustomerName" class="form-label">Customer Name</label>
                        <input type="text" class="form-control" id="editCustomerName" name="customerName" disabled>
                    </div>

                    <div class="mb-3">
                        <label for="editMobileNumber" class="form-label">Mobile Number</label>
                        <input type="text" class="form-control" id="editMobileNumber" name="mobileNumber">
                    </div>

                    <div class="mb-3">
                        <label for="editLeadFor" class="form-label">Lead For (Product/Service)</label>
                        <input type="text" class="form-control" id="editLeadFor" name="leadFor">
                    </div>

                    <div class="mb-3">
                        <label for="editLeadBy" class="form-label">Lead By (Source)</label>
                        <input type="text" class="form-control" id="editLeadBy" name="leadBy">
                    </div>

                    <div class="mb-3">
                        <label for="editLastContact" class="form-label">Last Contact</label>
                        <input type="datetime-local" class="form-control" id="editLastContact" name="lastContact">
                    </div>

                    <div class="mb-3">
                        <label for="editRemark" class="form-label">Remark</label>
                        <textarea class="form-control" id="editRemark" name="remark" rows="3"></textarea>
                    </div>
                    
                </form>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveLeadChanges">Save changes</button>
            </div>
        </div>
    </div>
</div>



    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
      import { 
        getAuth, 
        GoogleAuthProvider, 
        signInWithPopup, // <-- Function used for traditional Google Sign-In
        signInWithCredential, 
      } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js"; 
      import * as database from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

      // NOTE: Replace these placeholders with your actual Firebase Configuration
      const firebaseConfig = {
        apiKey: "AIzaSyCLb8Fcl_Yqqd0EYXciu5wbrAj7-mz1o9M",
        authDomain: "officetools-629fc.firebaseapp.com",
        projectId: "officetools-629fc",
        storageBucket: "officetools-629fc.firebasestorage.app",
        messagingSenderId: "888485297465",
        appId: "1:888485297465:web:f832733b7b78d361067ce8",
        databaseURL: "https://officetools-629fc-default-rtdb.firebaseio.com", 
        measurementId: "G-8QE15667LC"
      };
      
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const auth = getAuth(app);
      const db = database.getDatabase(app);
      const googleProvider = new GoogleAuthProvider();
      
      window.FIREBASE_USER_UID = null;
      window.isFirebaseAuthComplete = false;
      window.RTDB = db;
      // Define the global 'firebase' object so tool.js can access it
      window.firebase = { 
        auth: auth, 
        database: database,
        googleProvider: googleProvider, // Added the provider for tool.js
        signInWithPopup: signInWithPopup, // Added the method for tool.js
      };
      
      // GIS Credential handler is removed as the standard button doesn't use it.
      
      // Global Authentication State Listener
      auth.onAuthStateChanged(user => {
          if (user) {
              window.FIREBASE_USER_UID = user.uid;
              window.isFirebaseAuthComplete = true;
              if (typeof firebaseAuthSuccessHandler === 'function') {
                  firebaseAuthSuccessHandler(user);
              }
          } else {
              if (typeof firebaseAuthRequiredHandler === 'function') {
                  firebaseAuthRequiredHandler();
              }
          }
      });
      
    </script>

    <script src="./Assets/tool.js"></script>
    
</body>
</html>
